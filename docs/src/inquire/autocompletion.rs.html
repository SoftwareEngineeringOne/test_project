<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Source of the Rust file `/home/runner/.cargo/registry/src/index.crates.io-6f17d22bba15001f/inquire-0.7.5/src/autocompletion.rs`."><title>autocompletion.rs - source</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-492a78a4a87dcc01.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="inquire" data-themes="" data-resource-suffix="" data-rustdoc-version="1.82.0 (f6e511eec 2024-10-15)" data-channel="1.82.0" data-search-js="search-a99f1315e7cc5121.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../static.files/storage-118b08c4c78b968e.js"></script><script defer src="../../static.files/src-script-e66d777a5a92e9b2.js"></script><script defer src="../../src-files.js"></script><script defer src="../../static.files/main-921df33f47b8780c.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-3b12f09e550e0385.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc src"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="src-sidebar-title"><h2>Files</h2></div></nav><div class="sidebar-resizer"></div><main><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="example-wrap"><div data-nosnippet><pre class="src-line-numbers"><a href="#1" id="1">1</a>
<a href="#2" id="2">2</a>
<a href="#3" id="3">3</a>
<a href="#4" id="4">4</a>
<a href="#5" id="5">5</a>
<a href="#6" id="6">6</a>
<a href="#7" id="7">7</a>
<a href="#8" id="8">8</a>
<a href="#9" id="9">9</a>
<a href="#10" id="10">10</a>
<a href="#11" id="11">11</a>
<a href="#12" id="12">12</a>
<a href="#13" id="13">13</a>
<a href="#14" id="14">14</a>
<a href="#15" id="15">15</a>
<a href="#16" id="16">16</a>
<a href="#17" id="17">17</a>
<a href="#18" id="18">18</a>
<a href="#19" id="19">19</a>
<a href="#20" id="20">20</a>
<a href="#21" id="21">21</a>
<a href="#22" id="22">22</a>
<a href="#23" id="23">23</a>
<a href="#24" id="24">24</a>
<a href="#25" id="25">25</a>
<a href="#26" id="26">26</a>
<a href="#27" id="27">27</a>
<a href="#28" id="28">28</a>
<a href="#29" id="29">29</a>
<a href="#30" id="30">30</a>
<a href="#31" id="31">31</a>
<a href="#32" id="32">32</a>
<a href="#33" id="33">33</a>
<a href="#34" id="34">34</a>
<a href="#35" id="35">35</a>
<a href="#36" id="36">36</a>
<a href="#37" id="37">37</a>
<a href="#38" id="38">38</a>
<a href="#39" id="39">39</a>
<a href="#40" id="40">40</a>
<a href="#41" id="41">41</a>
<a href="#42" id="42">42</a>
<a href="#43" id="43">43</a>
<a href="#44" id="44">44</a>
<a href="#45" id="45">45</a>
<a href="#46" id="46">46</a>
<a href="#47" id="47">47</a>
<a href="#48" id="48">48</a>
<a href="#49" id="49">49</a>
<a href="#50" id="50">50</a>
<a href="#51" id="51">51</a>
<a href="#52" id="52">52</a>
<a href="#53" id="53">53</a>
<a href="#54" id="54">54</a>
<a href="#55" id="55">55</a>
<a href="#56" id="56">56</a>
<a href="#57" id="57">57</a>
<a href="#58" id="58">58</a>
<a href="#59" id="59">59</a>
<a href="#60" id="60">60</a>
<a href="#61" id="61">61</a>
<a href="#62" id="62">62</a>
<a href="#63" id="63">63</a>
<a href="#64" id="64">64</a>
<a href="#65" id="65">65</a>
<a href="#66" id="66">66</a>
<a href="#67" id="67">67</a>
<a href="#68" id="68">68</a>
<a href="#69" id="69">69</a>
<a href="#70" id="70">70</a>
<a href="#71" id="71">71</a>
<a href="#72" id="72">72</a>
<a href="#73" id="73">73</a>
<a href="#74" id="74">74</a>
<a href="#75" id="75">75</a>
<a href="#76" id="76">76</a>
<a href="#77" id="77">77</a>
<a href="#78" id="78">78</a>
<a href="#79" id="79">79</a>
<a href="#80" id="80">80</a>
<a href="#81" id="81">81</a>
<a href="#82" id="82">82</a>
<a href="#83" id="83">83</a>
<a href="#84" id="84">84</a>
<a href="#85" id="85">85</a>
<a href="#86" id="86">86</a>
<a href="#87" id="87">87</a>
<a href="#88" id="88">88</a>
<a href="#89" id="89">89</a>
<a href="#90" id="90">90</a>
<a href="#91" id="91">91</a>
<a href="#92" id="92">92</a>
<a href="#93" id="93">93</a>
<a href="#94" id="94">94</a>
<a href="#95" id="95">95</a>
<a href="#96" id="96">96</a>
<a href="#97" id="97">97</a>
<a href="#98" id="98">98</a>
<a href="#99" id="99">99</a>
<a href="#100" id="100">100</a>
</pre></div><pre class="rust"><code><span class="doccomment">//! Trait and structs used by prompts to provide autocompletion features.
//!
//! Autocompleters receive the user input to a given prompt and may return
//! a list of suggestions, selectable by the user as an option to be completed.
//!
//! When the user presses the autocompletion hotkey (`tab` by default) the
//! autocompleter receives the current text input and the currently highlighted
//! selection, if any. Then the developer may return a [Replacement] action
//! where the current user text input is replaced or not by a provided string.
//!
//! Check the example files to see some usages, recommended are `expense_tracker.rs`
//! and `complex_autocompletion.rs`.

</span><span class="kw">use </span>dyn_clone::DynClone;

<span class="kw">use </span><span class="kw">crate</span>::CustomUserError;

<span class="doccomment">/// Used when an autocompletion is triggered for the user's text input.
///
/// `None` means that no completion will be made.
/// `Some(String)` will replace the current text input with the `String` in `Some`.
</span><span class="kw">pub type </span>Replacement = <span class="prelude-ty">Option</span>&lt;String&gt;;

<span class="doccomment">/// Mechanism to implement autocompletion features for text inputs. The `Autocomplete` trait has two provided methods: `get_suggestions` and `get_completion`.
///
/// - `get_suggestions` is called whenever the user's text input is modified, e.g. a new letter is typed, returning a `Vec&lt;String&gt;`. The `Vec&lt;String&gt;` is the list of suggestions that the prompt displays to the user according to their text input. The user can then navigate through the list and if they submit while highlighting one of these suggestions, the suggestion is treated as the final answer.
/// - `get_completion` is called whenever the user presses the autocompletion hotkey (`tab` by default), with the current text input and the text of the currently highlighted suggestion, if any, as parameters. This method should return whether any text replacement (an autocompletion) should be made. If the prompt receives a replacement to be made, it substitutes the current text input for the string received from the `get_completion` call.
///
/// For example, in the `complex_autocompletion.rs` example file, the `FilePathCompleter` scans the file system based on the current text input, storing a list of paths that match the current text input.
///
/// Every time `get_suggestions` is called, the method returns the list of paths that match the user input. When the user presses the autocompletion hotkey, the `FilePathCompleter` checks whether there is any path selected from the list, if there is, it decides to replace the current text input for it. The interesting piece of functionality is that if there isn't a path selected from the list, the `FilePathCompleter` calculates the longest common prefix amongst all scanned paths and updates the text input to an unambiguous new value. Similar to how terminals work when traversing paths.
</span><span class="kw">pub trait </span>Autocomplete: DynClone {
    <span class="doccomment">/// List of input suggestions to be displayed to the user upon typing the
    /// text input.
    ///
    /// If the user presses the autocompletion hotkey (`tab` as default) with
    /// a suggestion highlighted, the user's text input will be replaced by the
    /// content of the suggestion string.
    </span><span class="kw">fn </span>get_suggestions(<span class="kw-2">&amp;mut </span><span class="self">self</span>, input: <span class="kw-2">&amp;</span>str) -&gt; <span class="prelude-ty">Result</span>&lt;Vec&lt;String&gt;, CustomUserError&gt;;

    <span class="doccomment">/// Standalone autocompletion that can be implemented based solely on the user's
    /// input.
    ///
    /// If the user presses the autocompletion hotkey (`tab` as default) and
    /// there are no suggestions highlighted (1), this function will be called in an
    /// attempt to autocomplete the user's input.
    ///
    /// If the returned value is of the `Some` variant, the text input will be replaced
    /// by the content of the string.
    ///
    /// (1) This applies where either there are no suggestions at all, or there are
    /// some displayed but the user hasn't highlighted any.
    </span><span class="kw">fn </span>get_completion(
        <span class="kw-2">&amp;mut </span><span class="self">self</span>,
        input: <span class="kw-2">&amp;</span>str,
        highlighted_suggestion: <span class="prelude-ty">Option</span>&lt;String&gt;,
    ) -&gt; <span class="prelude-ty">Result</span>&lt;Replacement, CustomUserError&gt;;
}

<span class="kw">impl </span>Clone <span class="kw">for </span>Box&lt;<span class="kw">dyn </span>Autocomplete&gt; {
    <span class="kw">fn </span>clone(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; <span class="self">Self </span>{
        dyn_clone::clone_box(<span class="kw-2">&amp;**</span><span class="self">self</span>)
    }
}

<span class="doccomment">/// Empty struct and implementation of Autocomplete trait. Used for the default
/// autocompleter of `Text` prompts.
</span><span class="attr">#[derive(Clone, Default)]
</span><span class="kw">pub struct </span>NoAutoCompletion;

<span class="kw">impl </span>Autocomplete <span class="kw">for </span>NoAutoCompletion {
    <span class="kw">fn </span>get_suggestions(<span class="kw-2">&amp;mut </span><span class="self">self</span>, <span class="kw">_</span>: <span class="kw-2">&amp;</span>str) -&gt; <span class="prelude-ty">Result</span>&lt;Vec&lt;String&gt;, CustomUserError&gt; {
        <span class="prelude-val">Ok</span>(<span class="macro">vec!</span>[])
    }

    <span class="kw">fn </span>get_completion(
        <span class="kw-2">&amp;mut </span><span class="self">self</span>,
        <span class="kw">_</span>: <span class="kw-2">&amp;</span>str,
        <span class="kw">_</span>: <span class="prelude-ty">Option</span>&lt;String&gt;,
    ) -&gt; <span class="prelude-ty">Result</span>&lt;Replacement, CustomUserError&gt; {
        <span class="prelude-val">Ok</span>(Replacement::None)
    }
}

<span class="kw">impl</span>&lt;F&gt; Autocomplete <span class="kw">for </span>F
<span class="kw">where
    </span>F: Fn(<span class="kw-2">&amp;</span>str) -&gt; <span class="prelude-ty">Result</span>&lt;Vec&lt;String&gt;, CustomUserError&gt; + Clone,
{
    <span class="kw">fn </span>get_suggestions(<span class="kw-2">&amp;mut </span><span class="self">self</span>, input: <span class="kw-2">&amp;</span>str) -&gt; <span class="prelude-ty">Result</span>&lt;Vec&lt;String&gt;, CustomUserError&gt; {
        (<span class="self">self</span>)(input)
    }

    <span class="kw">fn </span>get_completion(
        <span class="kw-2">&amp;mut </span><span class="self">self</span>,
        <span class="kw">_</span>: <span class="kw-2">&amp;</span>str,
        suggestion: <span class="prelude-ty">Option</span>&lt;String&gt;,
    ) -&gt; <span class="prelude-ty">Result</span>&lt;Replacement, CustomUserError&gt; {
        <span class="prelude-val">Ok</span>(suggestion)
    }
}
</code></pre></div></section></main></body></html>